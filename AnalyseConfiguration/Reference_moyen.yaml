R34:
  description: "Disable service accounts (non-exhaustive list)"
  expected:
    disabled_service_accounts:
      - "www-data"
      - "named"
      - "postgres"
      - "mysql"
      - "backup"
      - "lp"
      - "irc"
      - "games"
      - "nobody"
      - "mail"
      - "systemd-network"
      - "proxy"
      - "tcpdump"
      - "syslog"

R39:
  description: "Modify sudo configuration directives"
  expected:
    sudo_directives:
      - "Defaults noexec"
      - "Defaults requiretty"
      - "Defaults use_pty"
      - "Defaults umask=0027"
      - "Defaults ignore_dot"
      - "Defaults env_reset"

R40:
  description: "Use non-privileged target users for sudo commands"
  expected: []


R42:
  description: "Ban negations in sudo specifications"
  expected:
    no_negation_in_sudo: []

R43:
  description: "Specify arguments in sudo specifications"
  expected:
    strict_sudo_arguments: []

R44:
  description: "Edit files securely with sudo"
  expected:
    sudoedit_only: []

R50:
  description: "Restrict access permissions to sensitive files and directories"
  expected:
    secure_permissions:
      - "/etc/shadow 600"
      - "/etc/passwd 644"
      - "/etc/group 644"
      - "/etc/gshadow 600"
      - "/etc/ssh/sshd_config 600"
      - "/root/ 700"
      - "/var/log/auth.log 640"
      - "/var/log/syslog 640"
      - "/var/log/secure 640"
      - "/etc/cron.d 750"
      - "/etc/cron.daily 750"
      - "/etc/cron.hourly 750"
      - "/etc/cron.monthly 750"
      - "/etc/cron.weekly 750"
      - "/etc/fstab 644"
      - "/etc/securetty 600"
      - "/etc/security/limits.conf 644"
      - "/boot/grub/grub.cfg 600"
R52:
  description: "Restrict access to sockets and named pipes"
  expected:
    protected_sockets:
      - "/dev/log"
      - "/run/systemd/journal/socket"
      - "/var/run/docker.sock"
      - "/run/dbus/system_bus_socket"
      - "/run/udev/control"
      - "/var/run/mysqld/mysqld.sock"
      - "/var/run/postgresql/.s.PGSQL.5432"
      - "/var/run/php/php-fpm.sock"
      - "/run/systemd/private"
      - "/run/snapd.socket"
      - "/run/acpid.socket"
      - "/run/cups/cups.sock"
      - "/var/lib/lxcfs/cgroup"
      - "/run/systemd/notify"

R55:
  description: "Isolate user temporary directories"
  expected:
    user_private_tmp: []

R32:
  description: "Configure automatic session expiration and logind settings"
  expected:
    TMOUT: "600"
    logind_conf:
      IdleAction: "lock"
      IdleActionSec: "900s"
      RuntimeMaxSec: "3600s"

R70:
  description: "Separate system accounts and administrators from the directory"
  expected:
    local_users: []
    system_users:
      - "root"
      - "daemon"
      - "bin"
      - "sys"
      - "sync"
      - "games"
      - "man"
      - "lp"
      - "mail"
      - "news"
      - "uucp"
      - "proxy"
      - "www-data"
      - "backup"
      - "list"
      - "irc"
      - "gnats"
      - "nobody"
    admin_users: []
    ldap_users: []

R8:
  description: "Configure memory security options at boot"
  expected:
    memory_options:
      - "l1tf=full,force"
      - "page_poison=on"
      - "pti=on"
      - "slab_nomerge=yes"
      - "slub_debug=FZP"
      - "spec_store_bypass_disable=seccomp"
      - "spectre_v2=on"
      - "mds=full,nosmt"
      - "mce=0"
      - "page_alloc.shuffle=1"
      - "rng_core.default_quality=500"

R9:
  description: "Configure kernel security settings"
  expected:
    kernel_settings:
      kernel.dmesg_restrict: "1"
      kernel.kptr_restrict: "2"
      kernel.pid_max: "65536"
      kernel.perf_cpu_time_max_percent: "1"
      kernel.perf_event_max_sample_rate: "1"
      kernel.perf_event_paranoid: "2"
      kernel.randomize_va_space: "2"
      kernel.sysrq: "0"
      kernel.unprivileged_bpf_disabled: "1"
      kernel.panic_on_oops: "1"

R11:
  description: "Enable and configure Yama LSM"
  expected:
    yama_status:
      kernel.yama.ptrace_scope: "1"

R14:
  description: "Configure filesystem security settings"
  expected:
    filesystem_settings:
      fs.suid_dumpable: "0"
      fs.protected_fifos: "2"
      fs.protected_regular: "2"
      fs.protected_symlinks: "1"
      fs.protected_hardlinks: "1"

R35:
  description: "Use unique and exclusive service accounts"
  expected:
    unique_service_accounts: []

R63:
  description: "Disable non-essential service features"
  expected:
    disabled_service_features: []

R74:
  description: "Harden the local mail service (ignored if no mail service is running) All the criteria present in the compliance file must be validated, so they need to be modified beforehand or afterward to ensure proper compliance."
  expected:
    hardened_mail_service:
      listen_interfaces:
        - "127.0.0.1:25"
        - "[::1]:25"
      allow_local_delivery:
        - "localhost"
        - "localhost.lxd"
        - "HMS.lxd"
        - "$myhostname"


R75:
  description: "Configure a mail alias for service accounts (The function only detects aliases; it is necessary to manually check if the alias is correctly associated with the administrator's email. The detected elements come from the reference file. If none of the expected elements are found, the value of expected_elements will be an empty list. At least one alias is sufficient for the rule to be compliant.)"
  expected:
    mail_aliases:
      - "root"
      - "postmaster"
      - "admin"
